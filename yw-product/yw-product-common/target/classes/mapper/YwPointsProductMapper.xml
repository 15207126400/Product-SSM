<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunwei.product.common.dao.YwPointsProductDao">

    <sql id="sql">
         points_pro_id,
         points_pro_title,
         points_pro_img,
         points_pro_type,
         points_pro_needs,
         points_pro_stock,
         points_pro_sale_num,
         product_id,
         coupon_id,
         points_pro_createtime,
         points_pro_updatetime,
         showpage_status,
         status
    </sql>
    
    <sql id="insertSql">
         points_pro_title,
         points_pro_img,
         points_pro_type,
         points_pro_needs,
         points_pro_stock,
         points_pro_sale_num,
         product_id,
         coupon_id,
         points_pro_createtime,
         points_pro_updatetime,
         showpage_status,
         status
    </sql>
    <!-- 当前表条件 -->
    <sql id = "whereSql">
	   <where>
            <if test="points_pro_id != null and points_pro_id != '' ">
	          and points_pro_id = #{points_pro_id}
	        </if>
            <if test="points_pro_title != null and points_pro_title != '' ">
	          and points_pro_title = #{points_pro_title}
	        </if>
            <if test="points_pro_img != null and points_pro_img != '' ">
	          and points_pro_img = #{points_pro_img}
	        </if>
            <if test="points_pro_type != null and points_pro_type != '' ">
	          and points_pro_type = #{points_pro_type}
	        </if>
            <if test="points_pro_needs != null and points_pro_needs != '' ">
	          and points_pro_needs = #{points_pro_needs}
	        </if>
            <if test="points_pro_stock != null and points_pro_stock != '' ">
	          and points_pro_stock = #{points_pro_stock}
	        </if>
            <if test="points_pro_sale_num != null and points_pro_sale_num != '' ">
	          and points_pro_sale_num = #{points_pro_sale_num}
	        </if>
            <if test="product_id != null and product_id != '' ">
	          and product_id = #{product_id}
	        </if>
	        <if test="coupon_id != null and coupon_id != '' ">
	          and coupon_id = #{coupon_id}
	        </if>
            <if test="points_pro_createtime != null and points_pro_createtime != '' ">
	          and points_pro_createtime = #{points_pro_createtime}
	        </if>
            <if test="points_pro_updatetime != null and points_pro_updatetime != '' ">
	          and points_pro_updatetime = #{points_pro_updatetime}
	        </if>
	        <if test="showpage_status != null and showpage_status != '' ">
	          and showpage_status = #{showpage_status}
	        </if>
            <if test="status != null and status != '' ">
	          and status = #{status}
	        </if>
	    </where> 
    </sql>
    
    <!-- 当前表(或不存在当前表)条件(Map参数) -->
    <sql id = "whereMapSql">
	   <where>
            <if test="points_pro_id != null and points_pro_id != '' ">
	          and points_pro_id = #{points_pro_id}
	        </if>
            <if test="points_pro_title != null and points_pro_title != '' ">
	          and points_pro_title = #{points_pro_title}
	        </if>
            <if test="points_pro_img != null and points_pro_img != '' ">
	          and points_pro_img = #{points_pro_img}
	        </if>
            <if test="points_pro_type != null and points_pro_type != '' ">
	          and points_pro_type = #{points_pro_type}
	        </if>
            <if test="points_pro_needs != null and points_pro_needs != '' ">
	          and points_pro_needs = #{points_pro_needs}
	        </if>
            <if test="points_pro_stock != null and points_pro_stock != '' ">
	          and points_pro_stock = #{points_pro_stock}
	        </if>
            <if test="points_pro_sale_num != null and points_pro_sale_num != '' ">
	          and points_pro_sale_num = #{points_pro_sale_num}
	        </if>
            <if test="product_id != null and product_id != '' ">
	          and product_id = #{product_id}
	        </if>
	        <if test="coupon_id != null and coupon_id != '' ">
	          and coupon_id = #{coupon_id}
	        </if>
            <if test="points_pro_createtime != null and points_pro_createtime != '' ">
	          and points_pro_createtime = #{points_pro_createtime}
	        </if>
            <if test="points_pro_updatetime != null and points_pro_updatetime != '' ">
	          and points_pro_updatetime = #{points_pro_updatetime}
	        </if>
	        <if test="showpage_status != null and showpage_status != '' ">
	          and showpage_status = #{showpage_status}
	        </if>
            <if test="status != null and status != '' ">
	          and status = #{status}
	        </if>
	    </where> 
    </sql>
    
    <!-- 当前表批量删除条件 -->
    <sql id="whereBatchSql">
		<where>
			<if test="points_pro_id != null and points_pro_id != '' ">
				and points_pro_id in
				<foreach collection="points_pro_id" item="id" separator="," open="("
					close=")">
					#{id}
				</foreach>
			</if>
		</where>
	</sql>

	<!-- 当前表添加-->
	<insert id="insert" parameterType="com.yunwei.product.common.model.YwPointsProduct">
		insert into yw_points_product(<include refid="insertSql"/>) 
		values(
	             #{points_pro_title},
	             #{points_pro_img},
	             #{points_pro_type},
	             #{points_pro_needs},
	             #{points_pro_stock},
	             #{points_pro_sale_num},
	             #{product_id},
	             #{coupon_id},
	             #{points_pro_createtime},
	             #{points_pro_updatetime},
	             #{showpage_status},
	             #{status}
		     )
	</insert>
	
	<!-- 当前表查询(Map参数) -->
	<select id="queryList" parameterType="java.util.Map" resultType="com.yunwei.product.common.model.YwPointsProduct">
		select 
		 p.points_pro_id,
         p.points_pro_title,
         p.points_pro_type,
         p.points_pro_needs,
         p.points_pro_stock,
         p.points_pro_sale_num,
         p.product_id,
         p.coupon_id,
         p.points_pro_createtime,
         p.points_pro_updatetime,
         p.showpage_status,
         p.status,
		 b.thumbnail_url points_pro_img 
		from yw_points_product p 
		<choose>
			<when test="db_name == 'yw_images_xcxthumbnail' ">
				left join yw_images_xcxthumbnail b on p.points_pro_img = b.image_id and b.thumbnail_type = ${thumbnail_type}
			</when>
			<otherwise>
				left join yw_images_backthumbnail b on p.points_pro_img = b.image_id and b.thumbnail_type = ${thumbnail_type}
			</otherwise>
		</choose>
		<where>
			<if test="points_pro_id != null and points_pro_id != '' ">
	          and points_pro_id = #{points_pro_id}
	        </if>
			<if test="product_id != null and product_id != '' ">
	          and product_id = #{product_id}
	        </if>
	        <if test="coupon_id != null and coupon_id != '' ">
	          and coupon_id = #{coupon_id}
	        </if>
			<if test="points_pro_type != null and points_pro_type != '' ">
	          and points_pro_type = #{points_pro_type}
	        </if>
			<if test="showpage_status != null and showpage_status != '' ">
	          and showpage_status = #{showpage_status}
	        </if>
	        <if test="status != null and status != '' ">
	          and p.status = #{status}
	        </if>
		</where>
	</select>
	
	<!-- 当前表分页查询(Map参数) -->
	<select id="queryListPage" parameterType="java.util.Map" resultType="com.yunwei.product.common.model.YwPointsProduct">
		select 
		 p.points_pro_id,
         p.points_pro_title,
         p.points_pro_type,
         p.points_pro_needs,
         p.points_pro_stock,
         p.points_pro_sale_num,
         p.product_id,
         p.coupon_id,
         p.points_pro_createtime,
         p.points_pro_updatetime,
         p.showpage_status,
         p.status,
		 b.thumbnail_url points_pro_img 
		from yw_points_product p left join yw_images_backthumbnail b on p.points_pro_img = b.image_id and b.thumbnail_type = '1'
		order by points_pro_id desc
		limit #{begin},#{end}
	</select>
	
	<!-- 当前表查询总条数 -->
	<select id="queryTotals" parameterType="java.util.Map" resultType="int">
		select count(1) from yw_points_product
		<include refid="whereSql"/>
	</select>
	
	<!-- 当前表更新 -->
	<update id="update" parameterType="java.util.Map">
	    update yw_points_product
	     <trim prefix="set" suffixOverrides=",">
            <if test="points_pro_title != null and points_pro_title != '' ">
	           points_pro_title = #{points_pro_title},
	        </if>
            <if test="points_pro_img != null and points_pro_img != '' ">
	           points_pro_img = #{points_pro_img},
	        </if>
            <if test="points_pro_type != null and points_pro_type != '' ">
	           points_pro_type = #{points_pro_type},
	        </if>
            <if test="points_pro_needs != null and points_pro_needs != '' ">
	           points_pro_needs = #{points_pro_needs},
	        </if>
            <if test="points_pro_stock != null and points_pro_stock != '' ">
	           points_pro_stock = #{points_pro_stock},
	        </if>
            <if test="points_pro_sale_num != null and points_pro_sale_num != '' ">
	           points_pro_sale_num = #{points_pro_sale_num},
	        </if>
            <if test="product_id != null and product_id != '' ">
	           product_id = #{product_id},
	        </if>
	        <if test="coupon_id != null and coupon_id != '' ">
	           coupon_id = #{coupon_id},
	        </if>
            <if test="points_pro_createtime != null and points_pro_createtime != '' ">
	           points_pro_createtime = #{points_pro_createtime},
	        </if>
            <if test="points_pro_updatetime != null and points_pro_updatetime != '' ">
	           points_pro_updatetime = #{points_pro_updatetime},
	        </if>
	        <if test="showpage_status != null and showpage_status != '' ">
	           showpage_status = #{showpage_status},
	        </if>
            <if test="status != null and status != '' ">
	           status = #{status},
	        </if>
	    </trim>
	    <where>
             <if test="points_pro_id != null and points_pro_id != '' ">
	           and points_pro_id = #{points_pro_id}
	         </if>
	    </where>
	</update>
	
	<!-- 当前表删除 -->
	<delete id="delete" parameterType="java.util.Map">
	    delete from yw_points_product 
	    <where>
            <if test="points_pro_id != null and points_pro_id != '' ">
	           and points_pro_id = #{points_pro_id}
	        </if>
	    </where>
	</delete>
	
	<!-- 当前批量删除 -->
	<delete id="deleteBatch" parameterType="java.util.Map">
	   delete from yw_points_product
	   <include refid="whereBatchSql"/>
	</delete>
	
</mapper>